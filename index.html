<!DOCTYPE html>
<html>
   <head>
      
      <title>courrrt</title>
      
      <link rel="stylesheet" type="text/css" href="style/reset-min.css" />
      <link rel="stylesheet" type="text/css" href="script/lib/fancybox/jquery.fancybox-1.3.4.css" />
      <link rel="stylesheet/less" type="text/less" href="style/list.less" />
      
      <script type="text/javascript" src="script/lib/jquery-1.6.2.js"></script>
      <script type="text/javascript" src="script/lib/jquery-tmpl.js"></script>
      <script type="text/javascript" src="script/lib/jquery.timeago.js"></script>
      <script type="text/javascript" src="script/lib/fancybox/jquery.easing-1.3.pack.js"></script>
      <script type="text/javascript" src="script/lib/fancybox/jquery.fancybox-1.3.4.js"></script>
      <script type="text/javascript" src="script/lib/knockout-1.2.1.debug.js"></script>
      <script type="text/javascript" src="script/lib/less-1.1.4.js"></script>
      
      <script type="text/javascript" src="script/ext/ko.bindingHandlers.js"></script>
      
      <script type="text/javascript" src="script/models/player.js"></script>
      <script type="text/javascript" src="script/models/shot.js"></script>
      
      <script type="text/javascript" src="script/viewModels/viewModel.js"></script>
      <script type="text/javascript" src="script/viewModels/viewModel.list.js"></script>
      <script type="text/javascript" src="script/viewModels/viewModel.shot.js"></script>
      
      <script type="text/javascript">
         $(document).ready(function () {
            
            // Set HTML title
            courrrt.viewModel.list.subscribe(function () {
               window.document.title = this.title + " \u2192 " + this.list();
            }, window.courrrt.viewModel)
            
            // Default feed
            courrrt.viewModel.list("popular");
            
            // Ready, set...
            ko.applyBindings(courrrt.viewModel);
            
         });
      </script>
      
   </head>
   <body data-bind="scroll: { call: list.fetch, within: 500, of: 'bottom', watch: list.items }">
      
      <header class="page">
         <div class="wrapper">
            <nav>
               <ul data-bind="template: 'listFeeds'"></ul>
               <script id="listFeeds" type="text/x-jquery-tmpl">
                  {{each(name, url) list.feeds}}
                     <li data-bind="css: { selected: list() === name }, click: function () { list(name); }">
                        ${name}
                     </li>
                  {{/each}}
               </script>
            </nav>
         
            <h1 data-bind="text: title"></h1>
            <div class="loading" data-bind="visible: list.state() === 'loading'"></div>
         </div>
      </header>
      
      <section class="shots-list">
         <ul data-bind="template: { name: 'listItem', foreach: list.shots }"></ul>
         <script id="listItem" type="text/x-jquery-tmpl">
            <li data-bind="fancybox: { overlayColor: '#333A41', template: 'shotOverlay' }">
               <img src="${image.teaser_url}" class="teaser" />
            </li>
         </script>
         <script id="shotOverlay" type="text/x-jquery-tmpl">
            <section class="shot-overlay">
               <header>
                  <h1>${title}</h1>
                  <time data-bind="timeAgo: {}" datetime="${createdAt}"></time>
               </header>

               <img src="${image.url}" class="shot" />
               
               <aside>
                  <div class="player">
                     <img src="${player.avatar}" class="avatar" />
                     <h2>${player.name}</h2>
                     
                     <ul class="attributes">
                        {{if player.location.description}}
                           <li class="location">
                              <a href="${player.location.map}">${player.location.description}</a>
                           </li>
                        {{/if}}
                        <li class="dribbble">
                           <a href="${player.dribbble.profile}">${player.dribbble.username}</a>
                        </li>
                        {{if player.twitter.username}}
                           <li class="twitter">
                              <a href="${player.twitter.profile}">${player.twitter.username}</a>
                           </li>
                        {{/if}}
                     </ul>
                  </div>
                  <ul>
                  </ul>
               </aside>
            </section>
         </script>
      </section>
      
   </body>
</html>